<script>
  (function () {

    window.I18n = window.I18n || {};

    var language = window.I18n.language || 'en',
        baseUrl = window.I18n.baseUrl || '',
        locales = window.I18n.locales || {};

    /**
     * Translates the given key.
     * Also accepts multiple arguments which will be joined to build the key.
     */
    Polymer.Base.i18n = function () {
      var key = Array.prototype.join.call(arguments, '.');
      if (!locales[language]) {
        var url = baseUrl +  '/i18n/messages.' + language + '.json';
        var xhr = new XMLHttpRequest();
        // XXX synchronous requests are deprecated
        xhr.open('GET', url, false);
        xhr.onerror = function(e) {
         console.error("Failed to load " + url);
        };
        xhr.send();
        locales[language] = JSON.parse(xhr.responseText); // cache this locale.
      }
      return locales[language][key] || key;
    };
  })();
</script>